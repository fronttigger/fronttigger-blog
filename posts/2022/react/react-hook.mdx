---
title: React Hookê³¼ Closureì˜ ê´€ê³„ #required
tags:
  - react
  - hook
  - closure
  - javascript
published: true # required
date: '2022. 5. 17' # required
description: 'ìƒìƒë„ ëª»í•œ ì •ì²´! ã„´ã…‡ã„±' # required
thumbnailImg: '/thumbnail/2022/04/react-test/test-custom-hooks.png' # required
---

Reactì—ì„œÂ [hook](https://reactjs.org/docs/hooks-intro.html)ì€Â [16.8.0](https://github.com/facebook/react/blob/main/CHANGELOG.md#1680-february-6-2019)ì—ì„œ ì¶”ê°€ëœ ê¸°ëŠ¥ì´ë‹¤.

í˜„ì¬ ê¸°ì¤€ìœ¼ë¡œ ëŒ€ëµ 3ë…„ ì •ë„ ì „ì— ë“±ì¥í–ˆìœ¼ë©° ì²« ë“±ì¥ ì´í›„ë¡œ ìµœê·¼ê¹Œì§€ ì§€ì†ì ìœ¼ë¡œ í›…ë“¤ì´ ê°œì„ ë˜ê³ Â [ì¶”ê°€](https://github.com/reactjs/rfcs/tree/useevent/text)ë˜ê³  ìˆë‹¤.

ê·¸ë ‡ê²Œ í›…ì´ ë“±ì¥í•˜ë©´ì„œ ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì§ˆ ì»´í¬ë„ŒíŠ¸ì— í•œí•´ì„œ function componentë¥¼ ë¦¬ì•¡íŠ¸ íŒ€ì—ì„œÂ [ê¶Œì¥](https://ko.reactjs.org/docs/hooks-overview.html#but-what-is-a-hook)ë˜ê³ ìˆë‹¤.

ê·¸ë˜ì„œ í˜„ì¬ ê°œë°œí•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ì»´í¬ë„ŒíŠ¸ëŠ” íŠ¹ë³„í•œ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ëŒ€ë¶€ë¶„ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ ê°œë°œí•˜ë©´ì„œ í›…ì„ ì‚¬ìš©í•˜ê³  ìˆì„ ê²ƒì´ê³ , ë‚˜ ë˜í•œ ê·¸ë ‡ê²Œ í•˜ê³ ìˆë‹¤.

ê·¸ëŸ°ë° ê·¸ë ‡ê²Œë‚˜ ë§ì´ í›…ì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œí•˜ë©´ì„œ ì •ì‘ ì´ í›…ë“¤ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ì— ëŒ€í•´ì„  ìƒê°í•´ë³´ì§€ ëª»í–ˆë‹¤. ğŸ˜…

ëœ¨ë”í•˜ì—¬ ë°”ë¡œ ê´€ë ¨ëœ ì•„í‹°í´ì„ ì°¾ì•„ë³´ë‹¤ê°€ 2019ë…„ JSConfì—ì„œ ë°œí‘œí•œ [ìœ íŠœë¸Œ ìë£Œ](https://www.youtube.com/watch?v=KJP1E-Y-xyo)ê°€ ìˆì–´ ì´ë¥¼ ì‹œì²­í•˜ì˜€ê³  (ì˜ì–´ë¡œ ë˜ì–´ìˆì–´ì„œ ëª¨ë“ ê±¸ ì´í•´í•œê±´ ì•„ë‹ˆì§€ë§Œ..) ì •ë¦¬í•´ë‘ë©´ ë§ì€ ë„ì›€ì´ ë  ê²ƒ ê°™ì•˜ë‹¤.

### í´ë¡œì €ê°€ ë­ì§€..?

ì‚¬ì‹¤ ë¦¬ì•¡íŠ¸ë¥¼ í™œìš©í•´ ê°œë°œí•˜ê³  ìˆë‹¤ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ê°œë°œí•˜ê³  ìˆìœ¼ë¯€ë¡œ í´ë¡œì €ë¼ëŠ” ê°œë…ì— ëŒ€í•´ ë“¤ì–´ë³¸ ê²½í—˜ì´ ìˆì„ ê²ƒì´ë‹¤.

í´ë¡œì €ì— ëŒ€í•œ ê°œë…ì„ ì •ë§ ì—¬ëŸ¬ê°€ì§€ë¡œ ì •ì˜í•˜ê³  ìˆì§€ë§Œ ê°€ì¥ ì‰½ê³  ëª…í™•í•˜ê²Œ ì •ë¦¬í•œ ê°œë…ì´ ìˆë‹¤.

> en: closure makes it possible for a function to have "private" variables.  
> ko: í´ë¡œì €ëŠ” í•¨ìˆ˜ì— "ì‚¬ì ì¸" ë³€ìˆ˜ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.

ìš°ë¦¬ê°€ í‰ì†Œì— ë“¤ì—ˆë˜ \`ìº¡ìŠí™”\` ë¼ëŠ” ê°œë…ì´ ë°”ë¡œ ì—¬ê¸°ì„œ ë“±ì¥í•œë‹¤. ì–´ë–»ê²Œ ë³´ë©´ \`ìƒíƒœ\`ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³ ë„ ë§í•  ìˆ˜ ìˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ëŸ¬í•œ í˜•íƒœë¥¼ ë³´ì´ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” ì–´ë–¤ê²Œ ìˆì„ê¹Œ?

```
let foo = 1 // global scope

function add() {
  foo += 1
  return foo
}

console.log(add()) // 2
console.log(add()) // 3
console.log(add()) // 4
```

fooë¼ëŠ” ë³€ìˆ˜ì— 1ì„ ë”í•´ì£¼ëŠ” add í•¨ìˆ˜ê°€ ìˆë‹¤.

ì–¸ëœ» ë³´ë©´ ì˜ ë™ì‘í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

```
let foo = 1 // global scope

function add() {
  foo += 1
  return foo
}

console.log(add()) // 2
console.log(add()) // 3
foo = 9999
console.log(add()) // 10000
```

fooë¥¼ globalì—ì„œ ì ‘ê·¼í•˜ì—¬ ì„ì˜ë¡œ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ë‹¤.

ê·¸ë˜ì„œ ê¹¨ë‹¬ì•˜ë‹¤! ğŸ’¡

fooë¼ëŠ” ë³€ìˆ˜ë¥¼ ë°–ì—ì„œ ê±´ë“¤ì§€ ëª»í•˜ë„ë¡ í•´ì•¼ê² êµ¬ë‚˜!

ê·¸ë˜ì„œ ì´ë ‡ê²Œ ë³€ê²½í•´ë³´ì•˜ë‹¤.

```
function add() {
  let foo = 1
  foo += 1
  return foo
}

console.log(add()) // 2
console.log(add()) // 2
foo = 9999 // 'foo' is not defined.
console.log(add()) // 2
```

ì´ì œ ë°–ì—ì„œ ì ‘ê·¼í•˜ì§„ ëª»í•˜ì§€ë§Œ 2ê°’ì´ ë§¤ë²ˆ ì¶œë ¥ëœë‹¤.

ì´ëŠ” add í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ í•­ìƒ fooë¥¼ 1ë¡œ ì´ˆê¸°í™”í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ì´ë ‡ê²Œ ë‹¤ì‹œ ë³€ê²½í–ˆë‹¤.

```
function getAdd() {
  let foo = 1

  return function () {
    foo += 1

    return foo
  }
}

const add = getAdd()

console.log(add()) // 2
console.log(add()) // 3
foo = 9999 // 'foo' is not defined.
console.log(add()) // 4
```

ì´ë ‡ê²Œ ë˜ë©´ getAdd í•¨ìˆ˜ì—ì„œ add í•¨ìˆ˜ë¥¼ ë°˜í™˜í•´ í•¨ìˆ˜ë¥¼ add í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ ë§ˆë‹¤ getAdd í•¨ìˆ˜ì— ì„ ì–¸ë˜ì–´ìˆëŠ” fooì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  fooëŠ” **ë³€ê²½ëœ ê°’ì„ ìœ ì§€**í•œë‹¤.

ì—¬ê¸°ì„œ **ëª¨ë“ˆ íŒ¨í„´**ì„ í†µí•´ì„œë„ í´ë¡œì €ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```
const add = (function getAdd() {
  let foo = 1

  return function () {
    foo += 1

    return foo
  }
})()

console.log(add()) // 2
console.log(add()) // 3
console.log(add()) // 4
```

ì´ê²Œ ë°”ë¡œ í´ë¡œì €ë‹¤. (ë‘ë‘¥!)

ì´ëŠ” ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ì§€ë§Œ ë‚´ë¶€ì—ì„œëŠ” add í•¨ìˆ˜ ì‹¤í–‰ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

ë°”ë¡œ ì´ëŸ°ì ì„ í™œìš©í•˜ì—¬ React Hookì€ ë§Œë“¤ì–´ì¡Œë‹¤.

### closureë¥¼ useStateì— ì ìš©í•˜ê¸°

#### useState êµ¬í˜„

```
function useState(initVal) {
  let _val = initVal
  const state = () => _val
  const setState = (newVal) => {
    _val = newVal
  }

  return [state, setState]
}

const [count, setCount] = useState(1)
console.log(count()) // 1
setCount(2)
console.log(count()) // 2
```

initValì„ ì„ ì–¸ í›„ ê·¸ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì™€ ê°±ì‹ í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë°°ì—´ í˜•íƒœë¡œ ë°˜í™˜í•˜ë©´ ì™„ì„±ì´ë‹¤.

ê·¸ëŸ°ë° ìš°ë¦¬ëŠ” ë¦¬ì•¡íŠ¸ì—ì„œ useState í•¨ìˆ˜ë¥¼ ë°”ë¡œ ê°€ì ¸ì™€ ì‚¬ìš©í•˜ì§€ ëª»í•œë‹¤.

ë°”ë¡œ React ëª¨ë“ˆ ì•ˆì— ìœ„ì¹˜í•˜ê¸° ë•Œë¬¸ì¸ë°, ì•„ê¹Œ í´ë¡œì € í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆë˜ ë°©ì‹ëŒ€ë¡œ ëª¨ë“ˆ íŒ¨í„´ì„ ì‚¬ìš©í•´ë³´ì

```
const React = (function () {
  function useState(initVal) {
    let _val = initVal
    const state = () => _val
    const setState = (newVal) => {
      _val = newVal
    }

    return [state, setState]
  }

  return { useState }
})()

const [count, setCount] = React.useState(1)
console.log(count()) // 1
setCount(2)
console.log(count()) // 2
```

ì ê·¸ëŸ¬ë©´ ì´ì œ í›…ì„ ì‹¤í–‰í•  ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì

```
function Component() {
  const [count, setCount] = React.useState(1)

  return {
    render: () => console.log(count),
    click: () => setCount(count)
  }
}
```

ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ë Œë”ë§ê³¼ í´ë¦­ì— ëŒ€í•œ ê°’ì„ ë°˜í™˜í•´ì£¼ê³  ìˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ì œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì–´ë–»ê²Œ ë Œë”ë§ í•´ì£¼ì–´ì•¼í• ì§€ ì•Œë ¤ì¤˜ì•¼í•œë‹¤.

```
const React = (function () {
  function useState(initVal) {
    let _val = initVal
    const state = () => _val
    const setState = (newVal) => {
      _val = newVal
    }

    return [state, setState]
  }

  function render(Component) {
    const C = Component()
    C.render() // ì»´í¬ë„ŒíŠ¸ ë Œë”ë§

    return C
  }

  return { useState, render }
})()

function Component() {
  const [count, setCount] = React.useState(1)

  return {
    render: () => console.log(count),
    click: () => setCount(count),
  }
}

var App = React.render(Component) // Æ’ state() {}
App.click()
var App = React.render(Component) // Æ’ state() {}
```

í˜„ì¬ í•¨ìˆ˜ê°€ ì°íˆëŠ” ì´ìœ ëŠ” useStateì—ì„œ stateë¥¼ ë°˜í™˜ í•¨ìˆ˜ë¡œ ë³´ë‚´ì£¼ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ \_val ë³€ìˆ˜ë¥¼ ë°–ìœ¼ë¡œ ì´ë™ì‹œí‚¨ë‹¤.

ê·¸ëŸ¬ë©´ ì´ì œ í´ë¡œì €ì˜ í˜•íƒœëŠ” ìœ ì§€í•˜ë©´ì„œ initValê¹Œì§€ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•´ì§„ë‹¤.

```
const React = (function () {
  let _val

  function useState(initVal) {
    const state = _val || initVal
    const setState = (newVal) => {
      _val = newVal
    }

    return [state, setState]
  }

  function render(Component) {
    const C = Component()
    C.render()

    return C
  }

  return { useState, render }
})()

function Component() {
  const [count, setCount] = React.useState(1)

  return {
    render: () => console.log(count),
    click: () => setCount(count + 1),
  }
}

var App = React.render(Component) // 1
App.click()
var App = React.render(Component) // 2
```

ì ì—¬ê¸°ê¹Œì§€ ë³´ë©´ useState ì„ ì–¸, ë Œë”ë§ í›„ clickì„ í†µí•œ state ë³€ê²½ì´ ê°’ì´ ì˜ ìœ ì§€ëœ ì±„ë¡œ ì§„í–‰ë˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ useStateê°€ **ì—¬ëŸ¬ê°œ(2ê°œ ì´ìƒ)**ê°€ ì‚¬ìš©ëœë‹¤ë©´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šê²Œëœë‹¤.

### useStateë¥¼ ì—¬ëŸ¬ê°œ ì‚¬ìš©í•˜ê¸°
